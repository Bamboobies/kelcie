<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chocolate Thunder: Reclaim the Silverado - Hard Mode</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a2a44 0%, #2a3b5a 100%);
            color: #d4af37;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2vw;
        }
        #game-container {
            width: 100%;
            max-width: 900px;
            height: 92vh;
            background: #2a3b5a;
            padding: 4vw;
            border-radius: 2vw;
            box-shadow: 0 0 2vw rgba(0, 0, 0, 0.8), inset 0 0 1vw rgba(212, 175, 55, 0.2);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow-y: auto;
            border: 2px solid #d4af37;
        }
        h1 {
            font-size: clamp(1.8rem, 5.5vw, 2.8rem);
            margin-bottom: 1vh;
            text-shadow: 0 0 8px rgba(212, 175, 55, 0.6);
            text-align: center;
            letter-spacing: 0.1rem;
        }
        #status {
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            text-align: center;
            margin-bottom: 1vh;
            color: #e6c74c;
        }
        #output {
            font-size: clamp(1rem, 3.5vw, 1.3rem);
            flex-grow: 1;
            margin-bottom: 3vh;
            line-height: 1.7;
            text-align: justify;
            padding: 1vw;
            background: rgba(26, 42, 68, 0.9);
            border-radius: 1vw;
        }
        #choices {
            display: flex;
            flex-wrap: wrap;
            gap: 2vw;
            justify-content: center;
            padding-top: 1vh;
        }
        button {
            background: #d4af37;
            color: #1a2a44;
            border: 2px solid #b8932e;
            padding: clamp(0.8rem, 2.5vw, 1.2rem) clamp(1.5rem, 4vw, 2.2rem);
            font-size: clamp(0.95rem, 3vw, 1.15rem);
            border-radius: 1.5vw;
            cursor: pointer;
            flex: 1 1 45%;
            max-width: 220px;
            touch-action: manipulation;
            transition: all 0.3s ease;
            font-weight: bold;
            text-shadow: 0 0 2px rgba(26, 42, 68, 0.5);
        }
        button:hover {
            background: #e6c74c;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        button:active {
            transform: translateY(1px);
            box-shadow: none;
        }
        #game-container::-webkit-scrollbar {
            width: 0.6vw;
        }
        #game-container::-webkit-scrollbar-thumb {
            background: #d4af37;
            border-radius: 1vw;
            box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
        }
        #game-container::-webkit-scrollbar-track {
            background: #1a2a44;
        }
        @media (max-width: 600px) {
            button {
                flex: 1 1 100%;
                max-width: none;
            }
            #game-container {
                padding: 5vw;
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>Chocolate Thunder: Reclaim the Silverado - Hard Mode</h1>
        <div id="status"></div>
        <div id="output"></div>
        <div id="choices"></div>
    </div>

    <script>
        const output = document.getElementById('output');
        const choicesDiv = document.getElementById('choices');
        const statusDiv = document.getElementById('status');

        if (!output || !choicesDiv || !statusDiv) {
            document.body.innerHTML += "<p style='color: red;'>Error: Game elements not found. Check HTML IDs.</p>";
            throw new Error("DOM elements missing");
        }

        let gameState = {
            fuel: 5,
            ammo: 3,
            morale: 7,
            moves: 0,
            wins: 0,
            losses: 0
        };

        const scenes = {
            intro: {
                text: "You’re Chocolate Thunder, a grizzled libertarian renegade, and your silver Silverado—loaded with Mises books, freedom flags, and Athena’s six newborn pups—was nabbed by the FBI under Agent Hannah Montana’s glittery fist. You bolted with Athena, your chocolate lab, and Loagan, your chocolate-milk-chugging sidekick, into the desert night. The feds have your truck at the Desert Outpost, with whispers of an ATF handoff to their Canyon Stronghold. Fuel’s tight, BBs are few, and the team’s jittery. You growl, 'As Rothbard said, the state is a gang of thieves writ large—and they’ve got my ride!' Time to reclaim it—or die free.",
                choices: [{ text: "Start the rebellion", next: "baseCamp" }]
            },
            baseCamp: {
                text: "You’re holed up at a wind-battered desert camp, cacti swaying like sentinels. Athena paces, Loagan downs chocolate milk—'Keeps me sharp!' he claims. Your Silverado’s 20 miles away at the Desert Outpost, under drone watch and Hannah’s goons. Fuel’s low, ammo’s thin, and morale’s wobbly after the raid. A radio crackles: 'Suspect Thunder sighted—lock it down!' Time’s ticking—plan now or lose it all.",
                choices: [
                    { text: "Sneak toward Outpost (Fuel -1)", next: "sneakOut", cost: { fuel: 1 } },
                    { text: "Rig a trap with BBs (Ammo -1)", next: "trapSetup", cost: { ammo: 1 } },
                    { text: "Scout alone (Morale -1)", next: "soloScout", cost: { morale: 1 } }
                ]
            },
            sneakOut: {
                text: "You slip out under moonlight, Athena hushed, Loagan tripping—chocolate milk splashes. A rusted shed looms, maybe hiding gear, but a drone buzzes close. Outpost lights gleam ahead. Risk the shed or press on?",
                choices: [
                    { text: "Check shed (Morale -1)", next: "shedAmbush", cost: { morale: 1 } },
                    { text: "Bypass to Outpost (Fuel -1)", next: "outpostPerimeter", cost: { fuel: 1 } },
                    { text: "Hide from drone (Ammo -1 for flare)", next: "droneHide", cost: { ammo: 1 } }
                ]
            },
            trapSetup: {
                text: "You set a BB trap—'Precision chaos!' Loagan smirks. Feds storm in, trigger it—plink! They scatter, but a radio blares: 'Thunder’s here—backup now!' Your truck’s on a flatbed outside. Move fast.",
                choices: [
                    { text: "Chase flatbed (Fuel -2)", next: "flatbedChase", cost: { fuel: 2 } },
                    { text: "Fight feds (Ammo -1)", next: "fedBrawl", cost: { ammo: 1 } },
                    { text: "Hide and wait (Morale -2)", next: "trapHide", cost: { morale: 2 } }
                ]
            },
            soloScout: {
                text: "You ditch Loagan—'Guard the camp!' he nods, sipping chocolate milk—and scout with Athena. From a ridge, the Outpost glows: electrified fences, guards, your Silverado under a tarp. A canyon path beckons—dicey but concealed. Pick your move.",
                choices: [
                    { text: "Ambush guard (Ammo -1)", next: "guardAmbush", cost: { ammo: 1 } },
                    { text: "Take canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } },
                    { text: "Signal Loagan (Morale -1)", next: "loaganSignal", cost: { morale: 1 } }
                ]
            },
            shedAmbush: {
                text: "You boot the shed door—two feds leap out! Athena growls, Loagan swings his bottle—'Take that, suits!' Inside: a gas can (Fuel +2), a flare (Ammo +1), and a map. Fight or grab and go?",
                choices: [
                    { text: "Fight feds (Ammo -1)", next: "shedFight", cost: { ammo: 1 } },
                    { text: "Grab loot, flee (Morale -1)", next: "shedLoot", cost: { morale: 1 } }
                ]
            },
            outpostPerimeter: {
                text: "You hit the Outpost fence—electrified and humming. Your Silverado’s inside, pups whimpering. Hannah struts, barking: 'Drone sweep—Thunder’s near!' A sewer grate reeks nearby. Breach or bust?",
                choices: [
                    { text: "Cut fence (Fuel -1, Ammo -1)", next: "fenceBreach", cost: { fuel: 1, ammo: 1 } },
                    { text: "Sewer entry (Morale -2)", next: "sewerCrawl", cost: { morale: 2 } },
                    { text: "Distract with flare (Ammo -1)", next: "flareDistraction", cost: { ammo: 1 } }
                ]
            },
            droneHide: {
                text: "You dive under scrub, Loagan muttering—'Stealth mode engaged!' The drone passes, but a patrol nears, chatting about a ‘Canyon drop.’ Stay put or move?",
                choices: [
                    { text: "Stay hidden (Morale -1)", next: "patrolWait", cost: { morale: 1 } },
                    { text: "Ambush patrol (Ammo -1)", next: "patrolAmbush", cost: { ammo: 1 } },
                    { text: "Head to Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } }
                ]
            },
            flatbedChase: {
                text: "You bolt after the flatbed, Athena charging, Loagan lagging—'Legs weren’t built for this!' It’s Canyon-bound. A rusty ATV sits nearby. Chase on foot or ride?",
                choices: [
                    { text: "Chase on foot (Fuel -1, Morale -1)", next: "canyonPursuit", cost: { fuel: 1, morale: 1 } },
                    { text: "Steal ATV (Fuel -2)", next: "atvChase", cost: { fuel: 2 } },
                    { text: "Sabotage road (Ammo -1)", next: "roadBlock", cost: { ammo: 1 } }
                ]
            },
            fedBrawl: {
                text: "You deck a fed—Athena snaps, Loagan swings—'Fist of freedom!' Hannah aims: 'ATF’s got your pups, Thunder!' Flatbed rolls out. Fight on or bolt?",
                choices: [
                    { text: "Disarm Hannah (Ammo -1)", next: "hannahDisarm", cost: { ammo: 1 } },
                    { text: "Run to flatbed (Fuel -1)", next: "flatbedSprint", cost: { fuel: 1 } },
                    { text: "Retreat (Morale -2)", next: "brawlRetreat", cost: { morale: 2 } }
                ]
            },
            trapHide: {
                text: "You duck low—feds stomp by, radio screaming: 'Flatbed to Canyon—ATF’s ready.' Loagan whispers, 'I’m a shadow!' Tracks lead out. Follow or hold?",
                choices: [
                    { text: "Track flatbed (Fuel -1)", next: "canyonTrail", cost: { fuel: 1 } },
                    { text: "Stay hidden (Morale -1)", next: "hideWait", cost: { morale: 1 } }
                ]
            },
            guardAmbush: {
                text: "You tackle the guard—Athena pins him. He drops a keycard and radio: 'Canyon’s locked down!' Loagan grins, 'Outsmarted the taxman!' Take it or push?",
                choices: [
                    { text: "Grab keycard (Ammo -1 for flare)", next: "keycardTake", cost: { ammo: 1 } },
                    { text: "Rush Outpost (Fuel -1)", next: "outpostRush", cost: { fuel: 1 } },
                    { text: "Interrogate (Morale -1)", next: "guardQuestion", cost: { morale: 1 } }
                ]
            },
            canyonEntry: {
                text: "You slink into the Canyon—rock walls loom, Stronghold ahead. Your Silverado’s under floodlights, ATF trucks rolling in. A sniper glints above. Stealth or sprint?",
                choices: [
                    { text: "Sneak low (Morale -1)", next: "canyonSneak", cost: { morale: 1 } },
                    { text: "Sprint across (Fuel -2)", next: "canyonDash", cost: { fuel: 2 } },
                    { text: "Shoot sniper (Ammo -1)", next: "sniperShot", cost: { ammo: 1 } }
                ]
            },
            loaganSignal: {
                text: "You signal Loagan—he fires a BB, misses—'Aim’s not my forte!' Guards turn, flatbed rolls to Canyon. Chase or regroup?",
                choices: [
                    { text: "Chase flatbed (Fuel -2)", next: "canyonPursuit", cost: { fuel: 2 } },
                    { text: "Regroup with Loagan (Morale -1)", next: "regroupBase", cost: { morale: 1 } }
                ]
            },
            shedFight: {
                text: "You brawl—feds drop, but one radios: 'Thunder’s here!' Loot’s yours (Fuel +2, Ammo +1). Drones hum closer. Run or hunker down?",
                choices: [
                    { text: "Run to Outpost (Fuel -1)", next: "outpostWithLoot", cost: { fuel: 1 }, gain: { fuel: 2, ammo: 1 } },
                    { text: "Hide in shed (Morale -1)", next: "shedHideout", cost: { morale: 1 }, gain: { fuel: 2, ammo: 1 } }
                ]
            },
            shedLoot: {
                text: "You snag the loot (Fuel +2, Ammo +1)—Athena growls as a drone sweeps overhead. Loagan: 'They’ll never spot us!' Outpost or cover?",
                choices: [
                    { text: "Head to Outpost (Fuel -1)", next: "outpostWithLoot", cost: { fuel: 1 }, gain: { fuel: 2, ammo: 1 } },
                    { text: "Take cover (Morale -1)", next: "droneCover", cost: { morale: 1 }, gain: { fuel: 2, ammo: 1 } }
                ]
            },
            fenceBreach: {
                text: "You cut the fence—sparks fly! Alarms wail, Hannah shouts: 'ATF’s inbound!' Silverado’s 50 yards off, guarded. Charge or sneak?",
                choices: [
                    { text: "Charge truck (Fuel -1)", next: "truckCharge", cost: { fuel: 1 } },
                    { text: "Sneak around (Morale -1)", next: "sneakCompound", cost: { morale: 1 } }
                ]
            },
            sewerCrawl: {
                text: "You crawl the sewer—stench hits, Loagan groans—'Worse than bureaucracy!' You emerge inside, near a guard post. Silverado’s across the yard. Strike or slip?",
                choices: [
                    { text: "Ambush guards (Ammo -1)", next: "sewerAmbush", cost: { ammo: 1 } },
                    { text: "Slip past (Morale -1)", next: "yardSneak", cost: { morale: 1 } }
                ]
            },
            flareDistraction: {
                text: "You launch the flare—boom! Guards scatter, Hannah curses: 'My sequins!' Silverado’s open, but drones circle. Grab it or wait?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } },
                    { text: "Wait for drones (Morale -1)", next: "droneWait", cost: { morale: 1 } }
                ]
            },
            patrolWait: {
                text: "You hold—patrol moves off, radio crackling: 'Canyon’s locked—ATF’s there.' Loagan: 'Time’s our enemy!' Outpost or Canyon?",
                choices: [
                    { text: "To Outpost (Fuel -1)", next: "outpostPerimeter", cost: { fuel: 1 } },
                    { text: "To Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } }
                ]
            },
            patrolAmbush: {
                text: "You pounce—Athena leaps, Loagan swings—'Take that, statists!' Patrol drops a keycard and note: 'Junkyard decoy.' Grab it or go?",
                choices: [
                    { text: "Take keycard (Morale -1)", next: "keycardPatrol", cost: { morale: 1 } },
                    { text: "To Outpost (Fuel -1)", next: "outpostPerimeter", cost: { fuel: 1 } }
                ]
            },
            canyonPursuit: {
                text: "You chase—the flatbed hits the Canyon Stronghold. ATF trucks guard it, your Silverado gleaming. A sniper’s nest looms. Attack or flank?",
                choices: [
                    { text: "Attack head-on (Ammo -2)", next: "canyonAssault", cost: { ammo: 2 } },
                    { text: "Flank left (Fuel -1)", next: "canyonFlank", cost: { fuel: 1 } }
                ]
            },
            atvChase: {
                text: "You rev the ATV—Athena rides, Loagan clings—'Hold tight, pup!' Flatbed’s ahead, ATF drones buzzing. Ram or sabotage?",
                choices: [
                    { text: "Ram it (Fuel -2)", next: "atvRam", cost: { fuel: 2 } },
                    { text: "Sabotage tires (Ammo -1)", next: "atvSabotage", cost: { ammo: 1 } }
                ]
            },
            roadBlock: {
                text: "You trigger a rockslide—crash! Flatbed halts, agents spill out. Hannah radios: 'ATF’s got a decoy—Junkyard!' Fight or grab?",
                choices: [
                    { text: "Fight agents (Ammo -1)", next: "roadFight", cost: { ammo: 1 } },
                    { text: "Grab truck (Fuel -1)", next: "roadGrab", cost: { fuel: 1 } }
                ]
            },
            hannahDisarm: {
                text: "You disarm Hannah—she slips free, flatbed rolls. Radio: 'ATF’s at Canyon!' Loagan: 'She’s quick!' Chase or grab?",
                choices: [
                    { text: "Chase Hannah (Fuel -1)", next: "hannahChase", cost: { fuel: 1 } },
                    { text: "Grab truck (Morale -1)", next: "truckGrab", cost: { morale: 1 } }
                ]
            },
            flatbedSprint: {
                text: "You dash—flatbed’s gone, tracks lead to Canyon. Loagan huffs—'Need more cardio!' Hannah’s goons close in. Fight or follow?",
                choices: [
                    { text: "Fight goons (Ammo -1)", next: "goonFight", cost: { ammo: 1 } },
                    { text: "Follow tracks (Fuel -2)", next: "canyonTrail", cost: { fuel: 2 } }
                ]
            },
            brawlRetreat: {
                text: "You pull back—Hannah laughs: 'ATF’s got your pups!' Flatbed’s Canyon-bound. Loagan: 'We’ll get ‘em!' Regroup or pursue?",
                choices: [
                    { text: "Regroup (Morale -2)", next: "regroupBase", cost: { morale: 2 } },
                    { text: "Pursue (Fuel -2)", next: "canyonTrail", cost: { fuel: 2 } }
                ]
            },
            keycardTake: {
                text: "You grab the keycard—radio buzzes: 'Junkyard decoy active.' Loagan: 'Sneaky feds!' Outpost or Junkyard?",
                choices: [
                    { text: "To Outpost (Fuel -1)", next: "outpostWithKey", cost: { fuel: 1 } },
                    { text: "To Junkyard (Fuel -2)", next: "junkyardEntry", cost: { fuel: 2 } }
                ]
            },
            outpostRush: {
                text: "You charge—guards swarm, Hannah yells: 'ATF’s got a decoy!' Silverado’s here, but drones spot you. Fight or flee?",
                choices: [
                    { text: "Fight drones (Ammo -1)", next: "droneFight", cost: { ammo: 1 } },
                    { text: "Flee to truck (Fuel -1)", next: "truckFlee", cost: { fuel: 1 } }
                ]
            },
            guardQuestion: {
                text: "You lean on the guard—'Canyon’s the real drop!' he cracks. Loagan: 'Truth spills easy!' Canyon or Outpost?",
                choices: [
                    { text: "To Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } },
                    { text: "To Outpost (Fuel -1)", next: "outpostPerimeter", cost: { fuel: 1 } }
                ]
            },
            canyonSneak: {
                text: "You creep—ATF patrols tighten, your Silverado’s in a hangar. An informant hisses: 'Junkyard’s a trap!' Trust him or push?",
                choices: [
                    { text: "Trust informant (Fuel -1)", next: "informantReveal", cost: { fuel: 1 } },
                    { text: "Push to hangar (Morale -1)", next: "hangarApproach", cost: { morale: 1 } }
                ]
            },
            canyonDash: {
                text: "You sprint—sniper fires, grazes you! Silverado’s ahead, ATF loading pups. Loagan: 'Dodged that one!' Fight or grab?",
                choices: [
                    { text: "Fight sniper (Ammo -1)", next: "sniperFight", cost: { ammo: 1 } },
                    { text: "Grab truck (Fuel -1)", next: "canyonGrab", cost: { fuel: 1 } }
                ]
            },
            sniperShot: {
                text: "You shoot—sniper drops, but ATF spots you. Silverado’s close, pups whining. Charge or flank?",
                choices: [
                    { text: "Charge in (Fuel -1)", next: "canyonCharge", cost: { fuel: 1 } },
                    { text: "Flank around (Morale -1)", next: "canyonFlank", cost: { morale: 1 } }
                ]
            },
            outpostWithLoot: {
                text: "You hit the Outpost with loot—drones buzz, Hannah’s voice: 'ATF’s got a decoy!' Silverado’s guarded. Breach or distract?",
                choices: [
                    { text: "Breach gate (Ammo -1)", next: "gateBreach", cost: { ammo: 1 } },
                    { text: "Distract guards (Morale -1)", next: "guardDistraction", cost: { morale: 1 } }
                ]
            },
            shedHideout: {
                text: "You hunker—drones pass, but a fed spots tracks: 'Thunder’s near!' Loagan: 'We’re ghosts!' Outpost or bolt?",
                choices: [
                    { text: "To Outpost (Fuel -1)", next: "outpostPerimeter", cost: { fuel: 1 } },
                    { text: "Bolt to Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } }
                ]
            },
            droneCover: {
                text: "You duck—drone misses. Loagan: 'Out of sight, out of mind!' Outpost’s near, Canyon rumors grow. Where to?",
                choices: [
                    { text: "To Outpost (Fuel -1)", next: "outpostPerimeter", cost: { fuel: 1 } },
                    { text: "To Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } }
                ]
            },
            truckCharge: {
                text: "You charge—guards fire, Loagan dives—'Not my day!' Silverado’s locked, pups inside. Break in or pull back?",
                choices: [
                    { text: "Break lock (Ammo -1)", next: "truckBreak", cost: { ammo: 1 } },
                    { text: "Retreat (Morale -2)", next: "chargeRetreat", cost: { morale: 2 } }
                ]
            },
            sneakCompound: {
                text: "You slink—guards miss you, but a drone hovers. Silverado’s near, pups yipping. Shoot or slip?",
                choices: [
                    { text: "Shoot drone (Ammo -1)", next: "droneShot", cost: { ammo: 1 } },
                    { text: "Slip to truck (Morale -1)", next: "truckSlip", cost: { morale: 1 } }
                ]
            },
            sewerAmbush: {
                text: "You ambush—guards drop, but an alarm trips. Silverado’s across, ATF inbound. Run or fight?",
                choices: [
                    { text: "Run to truck (Fuel -1)", next: "truckRun", cost: { fuel: 1 } },
                    { text: "Fight guards (Ammo -1)", next: "sewerFight", cost: { ammo: 1 } }
                ]
            },
            yardSneak: {
                text: "You glide past—Silverado’s unguarded, but a rival crew eyes it: 'That’s ours, Thunder!' Loagan: 'Not today!' Confront or steal?",
                choices: [
                    { text: "Confront crew (Ammo -1)", next: "rivalConfront", cost: { ammo: 1 } },
                    { text: "Steal truck (Fuel -1)", next: "truckSteal", cost: { fuel: 1 } }
                ]
            },
            truckGrab: {
                text: "You seize the truck—pups yip, but gas is low. Hannah’s voice: 'ATF’s got a Junkyard trap!' Drive or siphon?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Siphon gas (Morale -1)", next: "siphonEscape", cost: { morale: 1 } }
                ]
            },
            droneWait: {
                text: "You wait—drones clear, but ATF trucks roll in. Silverado’s loaded, pups whining. Rush or retreat?",
                choices: [
                    { text: "Rush truck (Fuel -1)", next: "truckRush", cost: { fuel: 1 } },
                    { text: "Retreat (Morale -2)", next: "droneRetreat", cost: { morale: 2 } }
                ]
            },
            keycardPatrol: {
                text: "You take the keycard—note reads ‘Junkyard decoy.’ Loagan: 'Feds love tricks!' Outpost or Junkyard?",
                choices: [
                    { text: "To Outpost (Fuel -1)", next: "outpostWithKey", cost: { fuel: 1 } },
                    { text: "To Junkyard (Fuel -2)", next: "junkyardEntry", cost: { fuel: 2 } }
                ]
            },
            canyonAssault: {
                text: "You storm in—ATF fires back, Loagan ducks—'Bad day for this!' Silverado’s in sight, but a tank rolls up. Fight or flank?",
                choices: [
                    { text: "Fight tank (Ammo -2)", next: "tankFight", cost: { ammo: 2 } },
                    { text: "Flank to truck (Fuel -1)", next: "canyonFlank", cost: { fuel: 1 } }
                ]
            },
            canyonFlank: {
                text: "You flank—ATF misses, Silverado’s near. A rival crew jumps you: 'Truck’s ours!' Loagan: 'Over my dead boots!' Fight or bribe?",
                choices: [
                    { text: "Fight crew (Ammo -1)", next: "rivalFight", cost: { ammo: 1 } },
                    { text: "Bribe with gas (Fuel -1)", next: "rivalBribe", cost: { fuel: 1 } }
                ]
            },
            atvRam: {
                text: "You ram—ATV flips, Loagan yells—'Rough landing!' Flatbed stops, but ATF surrounds. Fight or surrender?",
                choices: [
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } },
                    { text: "Surrender (Morale -3)", next: "atfSurrender", cost: { morale: 3 } }
                ]
            },
            atvSabotage: {
                text: "You shoot tires—flatbed crashes! ATF scrambles, Silverado’s free. Loagan: 'Nailed it!' Grab or fight?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "canyonGrab", cost: { fuel: 1 } },
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            roadFight: {
                text: "You fight—agents drop, but Hannah radios: 'ATF’s at Junkyard!' Silverado’s yours, low on gas. Drive or siphon?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Siphon gas (Morale -1)", next: "siphonEscape", cost: { morale: 1 } }
                ]
            },
            roadGrab: {
                text: "You grab it—pups yip, but a drone tags you. Hannah: 'ATF’s closing!' Drive or shoot?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Shoot drone (Ammo -1)", next: "droneShot", cost: { ammo: 1 } }
                ]
            },
            hannahChase: {
                text: "You chase—Hannah traps you with drones! Loagan: 'She’s crafty!' Flatbed hits Junkyard. Fight or flee?",
                choices: [
                    { text: "Fight drones (Ammo -1)", next: "droneFight", cost: { ammo: 1 } },
                    { text: "Flee to Junkyard (Fuel -2)", next: "junkyardEntry", cost: { fuel: 2 } }
                ]
            },
            goonFight: {
                text: "You brawl—goons fall, but flatbed’s gone. Tracks lead to Canyon. Loagan: 'Knuckles still work!' Follow or regroup?",
                choices: [
                    { text: "Follow to Canyon (Fuel -2)", next: "canyonTrail", cost: { fuel: 2 } },
                    { text: "Regroup (Morale -1)", next: "regroupBase", cost: { morale: 1 } }
                ]
            },
            canyonTrail: {
                text: "You track it—Canyon Stronghold looms, ATF thick. Silverado’s in a hangar, pups whining. Sneak or charge?",
                choices: [
                    { text: "Sneak in (Morale -1)", next: "canyonSneak", cost: { morale: 1 } },
                    { text: "Charge hangar (Fuel -1)", next: "hangarCharge", cost: { fuel: 1 } }
                ]
            },
            hideWait: {
                text: "You wait—feds clear out, but Canyon’s locked. Loagan: 'Patience pays!' Tracks fade. Canyon or Outpost?",
                choices: [
                    { text: "To Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } },
                    { text: "To Outpost (Fuel -1)", next: "outpostPerimeter", cost: { fuel: 1 } }
                ]
            },
            outpostWithKey: {
                text: "You swipe the keycard—gate opens, but Hannah’s there: 'ATF’s got a decoy!' Silverado’s close. Rush or sneak?",
                choices: [
                    { text: "Rush truck (Fuel -1)", next: "truckRush", cost: { fuel: 1 } },
                    { text: "Sneak past (Morale -1)", next: "sneakCompound", cost: { morale: 1 } }
                ]
            },
            junkyardEntry: {
                text: "You reach the Junkyard Maze—rusty wrecks everywhere. A decoy Silverado sits, but pups whine elsewhere. Hannah’s voice: 'ATF’s real prize is Canyon!' Search or leave?",
                choices: [
                    { text: "Search Junkyard (Fuel -1)", next: "junkyardSearch", cost: { fuel: 1 } },
                    { text: "To Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } }
                ]
            },
            droneFight: {
                text: "You shoot—drones crash, but ATF rolls in. Silverado’s near, pups inside. Fight or grab?",
                choices: [
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } },
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } }
                ]
            },
            truckFlee: {
                text: "You bolt—Silverado’s yours, but gas is low. Drones pursue, Hannah: 'ATF’s got you!' Drive or shoot?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Shoot drones (Ammo -1)", next: "droneShot", cost: { ammo: 1 } }
                ]
            },
            informantReveal: {
                text: "Informant spills: 'Silverado’s in Canyon hangar—Junkyard’s a trap!' Loagan: 'Gut’s never wrong!' Trust him or check?",
                choices: [
                    { text: "Trust, to hangar (Fuel -1)", next: "hangarApproach", cost: { fuel: 1 } },
                    { text: "Check Junkyard (Fuel -2)", next: "junkyardEntry", cost: { fuel: 2 } }
                ]
            },
            hangarApproach: {
                text: "You near the hangar—ATF guards swarm, Silverado inside. A rival crew lurks: 'Truck’s ours!' Loagan: 'Not on my watch!' Fight or sneak?",
                choices: [
                    { text: "Fight crew (Ammo -1)", next: "rivalFight", cost: { ammo: 1 } },
                    { text: "Sneak in (Morale -1)", next: "hangarSneak", cost: { morale: 1 } }
                ]
            },
            sniperFight: {
                text: "You fight—sniper’s down, but ATF closes in. Silverado’s near, pups yipping. Grab or hold?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "canyonGrab", cost: { fuel: 1 } },
                    { text: "Hold ground (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            canyonCharge: {
                text: "You charge—ATF fires, Loagan ducks—'Too close!' Silverado’s close, pups inside. Break in or retreat?",
                choices: [
                    { text: "Break in (Ammo -1)", next: "hangarBreak", cost: { ammo: 1 } },
                    { text: "Retreat (Morale -2)", next: "canyonRetreat", cost: { morale: 2 } }
                ]
            },
            gateBreach: {
                text: "You breach—guards swarm, Silverado’s ahead. Hannah: 'ATF’s got a Junkyard decoy!' Fight or grab?",
                choices: [
                    { text: "Fight guards (Ammo -1)", next: "gateFight", cost: { ammo: 1 } },
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } }
                ]
            },
            guardDistraction: {
                text: "You distract—guards chase the flare, Silverado’s open. Loagan: 'Suckers!' Grab or wait?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } },
                    { text: "Wait for clear (Morale -1)", next: "waitClear", cost: { morale: 1 } }
                ]
            },
            truckBreak: {
                text: "You smash the lock—pups yip, but ATF drones spot you. Hannah: 'ATF’s here!' Drive or shoot?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Shoot drones (Ammo -1)", next: "droneShot", cost: { ammo: 1 } }
                ]
            },
            chargeRetreat: {
                text: "You retreat—ATF locks down, flatbed moves to Canyon. Loagan: 'We’ll regroup!' Follow or hunker?",
                choices: [
                    { text: "Follow to Canyon (Fuel -2)", next: "canyonTrail", cost: { fuel: 2 } },
                    { text: "Regroup (Morale -1)", next: "regroupBase", cost: { morale: 1 } }
                ]
            },
            droneShot: {
                text: "You shoot—drone crashes! Silverado’s yours, but ATF closes in. Drive or fight?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            truckSlip: {
                text: "You slip in—Silverado’s yours, pups safe. Drones buzz, Hannah: 'ATF’s coming!' Drive or hide?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Hide in compound (Morale -1)", next: "compoundHide", cost: { morale: 1 } }
                ]
            },
            truckRun: {
                text: "You run—Silverado’s yours, but gas is low. ATF pursues, Loagan: 'Need a boost!' Drive or siphon?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Siphon gas (Morale -1)", next: "siphonEscape", cost: { morale: 1 } }
                ]
            },
            sewerFight: {
                text: "You fight—guards fall, but ATF rolls in. Silverado’s close, pups yipping. Grab or hold?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } },
                    { text: "Hold ground (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            rivalConfront: {
                text: "You confront—crew fires, Loagan ducks—'Not today!' Silverado’s yours if you win. Fight or bribe?",
                choices: [
                    { text: "Fight crew (Ammo -1)", next: "rivalFight", cost: { ammo: 1 } },
                    { text: "Bribe with gas (Fuel -1)", next: "rivalBribe", cost: { fuel: 1 } }
                ]
            },
            truckSteal: {
                text: "You steal it—pups yip, but crew shoots! Loagan: 'Keep moving!' Drive or fight?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Fight crew (Ammo -1)", next: "rivalFight", cost: { ammo: 1 } }
                ]
            },
            truckRush: {
                text: "You rush—ATF fires, Silverado’s near. Loagan: 'Too fast for ‘em!' Grab or retreat?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } },
                    { text: "Retreat (Morale -2)", next: "rushRetreat", cost: { morale: 2 } }
                ]
            },
            droneRetreat: {
                text: "You pull back—ATF locks down, flatbed moves to Junkyard. Loagan: 'We’ll hit back!' Follow or regroup?",
                choices: [
                    { text: "To Junkyard (Fuel -2)", next: "junkyardEntry", cost: { fuel: 2 } },
                    { text: "Regroup (Morale -1)", next: "regroupBase", cost: { morale: 1 } }
                ]
            },
            tankFight: {
                text: "You fight—tank blasts, Loagan yells—'Big mistake!' Silverado’s close, but ATF swarms. Grab or flee?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "canyonGrab", cost: { fuel: 1 } },
                    { text: "Flee (Morale -2)", next: "canyonRetreat", cost: { morale: 2 } }
                ]
            },
            rivalFight: {
                text: "You fight—crew falls, Silverado’s yours. ATF drones buzz, Loagan: 'We’re golden!' Drive or shoot?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Shoot drones (Ammo -1)", next: "droneShot", cost: { ammo: 1 } }
                ]
            },
            rivalBribe: {
                text: "You bribe—crew backs off, Silverado’s yours. ATF rolls in, Loagan: 'Smooth move!' Drive or fight?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            atfFight: {
                text: "You fight—ATF falls, but more come. Silverado’s near, pups yipping. Grab or hold?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "canyonGrab", cost: { fuel: 1 } },
                    { text: "Hold ground (Ammo -1)", next: "atfHold", cost: { ammo: 1 } }
                ]
            },
            atfSurrender: {
                text: "Game Over! You surrender—ATF cuffs you, pups lost. Hannah: 'Freedom’s a myth!' Liberty’s dead.",
                choices: []
            },
            canyonGrab: {
                text: "You grab it—pups yip, but fuel’s low. ATF pursues, Loagan: 'Floor it!' Drive or siphon?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Siphon gas (Morale -1)", next: "siphonEscape", cost: { morale: 1 } }
                ]
            },
            junkyardSearch: {
                text: "You search—decoy’s empty, radio buzzes: 'Real truck’s at ATF Depot!' Loagan: 'Knew it!' Canyon or Depot?",
                choices: [
                    { text: "To Canyon (Fuel -2)", next: "canyonEntry", cost: { fuel: 2 } },
                    { text: "To Depot (Fuel -3)", next: "depotEntry", cost: { fuel: 3 } }
                ]
            },
            hangarCharge: {
                text: "You charge—ATF fires, Loagan ducks—'Not my moment!' Silverado’s inside, pups whining. Break in or retreat?",
                choices: [
                    { text: "Break in (Ammo -1)", next: "hangarBreak", cost: { ammo: 1 } },
                    { text: "Retreat (Morale -2)", next: "canyonRetreat", cost: { morale: 2 } }
                ]
            },
            hangarSneak: {
                text: "You sneak—ATF misses, Silverado’s unguarded. Pups yip, but a trap hums. Loagan: 'Trap sense tingling!' Disarm or grab?",
                choices: [
                    { text: "Disarm trap (Ammo -1)", next: "trapDisarm", cost: { ammo: 1 } },
                    { text: "Grab truck (Fuel -1)", next: "hangarGrab", cost: { fuel: 1 } }
                ]
            },
            hangarBreak: {
                text: "You break in—pups yip, Silverado’s yours. ATF swarms, Loagan: 'Time to roll!' Drive or fight?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            canyonRetreat: {
                text: "You retreat—Canyon’s lost, flatbed moves to Depot. Loagan: 'Next round’s ours!' Follow or regroup?",
                choices: [
                    { text: "To Depot (Fuel -3)", next: "depotEntry", cost: { fuel: 3 } },
                    { text: "Regroup (Morale -1)", next: "regroupBase", cost: { morale: 1 } }
                ]
            },
            gateFight: {
                text: "You fight—guards drop, Silverado’s near. Drones buzz, Loagan: 'Keep ‘em coming!' Grab or shoot?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } },
                    { text: "Shoot drones (Ammo -1)", next: "droneShot", cost: { ammo: 1 } }
                ]
            },
            waitClear: {
                text: "You wait—guards leave, Silverado’s open. ATF rolls in, Loagan: 'Now or never!' Grab or retreat?",
                choices: [
                    { text: "Grab truck (Fuel -1)", next: "truckGrab", cost: { fuel: 1 } },
                    { text: "Retreat (Morale -2)", next: "clearRetreat", cost: { morale: 2 } }
                ]
            },
            driveEscape: {
                text: "Victory! You peel out—pups yip, Loagan cheers: 'Ayn Rand would call this the triumph of reason!' Silverado roars free—liberty’s yours, Thunder!",
                choices: []
            },
            siphonEscape: {
                text: "You siphon—ATF closes in! Loagan: 'Hurry up!' Drive now or fight?",
                choices: [
                    { text: "Drive out (Fuel -1)", next: "driveEscape", cost: { fuel: 1 } },
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            compoundHide: {
                text: "You hide—ATF searches, misses. Silverado’s ready, pups safe. Loagan: 'They’re clueless!' Drive or wait?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Wait longer (Morale -1)", next: "hideWaitDepot", cost: { morale: 1 } }
                ]
            },
            rushRetreat: {
                text: "You retreat—ATF locks down, flatbed moves to Depot. Loagan: 'We’ll strike back!' Follow or regroup?",
                choices: [
                    { text: "To Depot (Fuel -3)", next: "depotEntry", cost: { fuel: 3 } },
                    { text: "Regroup (Morale -1)", next: "regroupBase", cost: { morale: 1 } }
                ]
            },
            atfHold: {
                text: "You hold—ATF overwhelms, Loagan cracks: 'Out of tricks!' Surrender or die?",
                choices: [
                    { text: "Surrender (Morale -3)", next: "atfSurrender", cost: { morale: 3 } },
                    { text: "Die fighting (Ammo -1)", next: "lastStand", cost: { ammo: 1 } }
                ]
            },
            junkyardTrap: {
                text: "Game Over! You search—trap springs! Hannah: 'Caught you!' Pups are Depot-bound, you’re done.",
                choices: []
            },
            depotEntry: {
                text: "You hit the ATF Depot—steel fortress, Silverado inside, pups caged. Hannah’s there: 'Endgame, Thunder!' Breach or scout?",
                choices: [
                    { text: "Breach gate (Ammo -2)", next: "depotBreach", cost: { ammo: 2 } },
                    { text: "Scout perimeter (Fuel -1)", next: "depotScout", cost: { fuel: 1 } }
                ]
            },
            trapDisarm: {
                text: "You disarm—trap fizzles, Silverado’s yours. ATF closes in, Loagan: 'Close call!' Drive or fight?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } }
                ]
            },
            hangarGrab: {
                text: "You grab—trap springs! Loagan: 'Bad move!' ATF swarms, pups in peril. Fight or flee?",
                choices: [
                    { text: "Fight ATF (Ammo -1)", next: "atfFight", cost: { ammo: 1 } },
                    { text: "Flee (Morale -2)", next: "canyonRetreat", cost: { morale: 2 } }
                ]
            },
            clearRetreat: {
                text: "You retreat—ATF locks down, flatbed moves to Depot. Loagan: 'We’ll get ‘em!' Follow or regroup?",
                choices: [
                    { text: "To Depot (Fuel -3)", next: "depotEntry", cost: { fuel: 3 } },
                    { text: "Regroup (Morale -1)", next: "regroupBase", cost: { morale: 1 } }
                ]
            },
            hideWaitDepot: {
                text: "You wait—ATF leaves, Silverado’s clear. Loagan: 'Timing’s everything!' Drive or check?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Check truck (Morale -1)", next: "checkTrap", cost: { morale: 1 } }
                ]
            },
            lastStand: {
                text: "Game Over! You fight—ATF cuts you down. Pups are lost, Loagan wails: 'End of the line!' Freedom dies.",
                choices: []
            },
            depotBreach: {
                text: "You breach—ATF fires, Hannah cackles: 'Game’s up!' Silverado’s inside, pups caged. Fight or grab?",
                choices: [
                    { text: "Fight Hannah (Ammo -1)", next: "hannahFinal", cost: { ammo: 1 } },
                    { text: "Grab truck (Fuel -1)", next: "depotGrab", cost: { fuel: 1 } }
                ]
            },
            depotScout: {
                text: "You scout—a weak vent leads in, drones patrol. Silverado’s deep inside, pups whining. Vent or attack?",
                choices: [
                    { text: "Through vent (Morale -1)", next: "ventEntry", cost: { morale: 1 } },
                    { text: "Attack gate (Ammo -2)", next: "depotBreach", cost: { ammo: 2 } }
                ]
            },
            checkTrap: {
                text: "Game Over! You check—tracker explodes! Hannah: 'Too slow!' Pups are lost, you’re done.",
                choices: []
            },
            hannahFinal: {
                text: "You fight—Hannah falls, Silverado’s yours! ATF swarms, Loagan: 'We’re legends!' Drive or hold?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Hold ground (Ammo -1)", next: "atfHold", cost: { ammo: 1 } }
                ]
            },
            depotGrab: {
                text: "You grab—pups yip, but Hannah shoots! Loagan: 'Duck!' Drive or fight?",
                choices: [
                    { text: "Drive out (Fuel -2)", next: "driveEscape", cost: { fuel: 2 } },
                    { text: "Fight Hannah (Ammo -1)", next: "hannahFinal", cost: { ammo: 1 } }
                ]
            },
            ventEntry: {
                text: "You crawl—vent leads to Silverado, pups safe. Hannah waits: 'Sneaky!' Fight or grab?",
                choices: [
                    { text: "Fight Hannah (Ammo -1)", next: "hannahFinal", cost: { ammo: 1 } },
                    { text: "Grab truck (Fuel -1)", next: "depotGrab", cost: { fuel: 1 } }
                ]
            },
            regroupBase: {
                text: "Game Over! You regroup—ATF moves pups to Depot. Loagan: 'We’re too late!' Freedom’s lost.",
                choices: []
            },
            stranded: {
                text: "Game Over! Fuel’s gone—Silverado stalls. ATF swarms, Loagan groans: 'Out of juice!' You’re caught.",
                choices: []
            },
            outOfAmmo: {
                text: "Game Over! Ammo’s out—ATF overwhelms. Pups are lost, Loagan sighs: 'No shots left!' Liberty dies.",
                choices: []
            },
            desertion: {
                text: "Game Over! Morale breaks—Loagan bolts: 'I’m out!' Pups are lost, you’re alone—freedom’s gone.",
                choices: []
            }
        };

        let currentScene = 'intro';

        window.onload = () => {
            displayScene();
        };

        function updateStatus() {
            statusDiv.textContent = `Fuel: ${gameState.fuel} | Ammo: ${gameState.ammo} | Morale: ${gameState.morale} | Moves: ${gameState.moves} | Wins: ${gameState.wins} | Losses: ${gameState.losses}`;
        }

        function checkGameOver() {
            if (gameState.fuel < 0) return 'stranded';
            if (gameState.ammo < 0) return 'outOfAmmo';
            if (gameState.morale < 0) return 'desertion';
            return null;
        }

        function displayScene() {
            const scene = scenes[currentScene];
            if (!scene) {
                output.innerHTML = "Error: Scene not found!";
                return;
            }

            output.innerHTML = scene.text || "No text available";
            choicesDiv.innerHTML = '';
            gameState.moves++;
            updateStatus();

            const gameOver = checkGameOver();
            if (gameOver) {
                currentScene = gameOver;
                displayScene();
                return;
            }

            if (scene.choices.length === 0) {
                if (scene.text.startsWith("Victory!")) {
                    gameState.wins++;
                    output.innerHTML += "<br><br><strong>Freedom Prevails!</strong>";
                } else {
                    gameState.losses++;
                    output.innerHTML += "<br><br><strong>Liberty Lost!</strong>";
                }
                updateStatus();

                const restartButton = document.createElement('button');
                restartButton.textContent = 'Reclaim Again, Renegade!';
                restartButton.onclick = () => {
                    currentScene = 'intro';
                    gameState = { fuel: 5, ammo: 3, morale: 7, moves: 0, wins: gameState.wins, losses: gameState.losses };
                    displayScene();
                };
                choicesDiv.appendChild(restartButton);
            } else {
                let allChoicesDisabled = true;
                scene.choices.forEach(choice => {
                    const button = document.createElement('button');
                    button.textContent = choice.text;
                    button.onclick = () => {
                        if (choice.cost) {
                            if (choice.cost.fuel) gameState.fuel -= choice.cost.fuel;
                            if (choice.cost.ammo) gameState.ammo -= choice.cost.ammo;
                            if (choice.cost.morale) gameState.morale -= choice.cost.morale;
                        }
                        if (choice.gain) {
                            if (choice.gain.fuel) gameState.fuel += choice.gain.fuel;
                            if (choice.gain.ammo) gameState.ammo += choice.gain.ammo;
                        }
                        currentScene = choice.next;
                        displayScene();
                    };
                    button.disabled = (choice.cost && (
                        (choice.cost.fuel && gameState.fuel < choice.cost.fuel) ||
                        (choice.cost.ammo && gameState.ammo < choice.cost.ammo) ||
                        (choice.cost.morale && gameState.morale < choice.cost.morale)
                    ));
                    if (!button.disabled) allChoicesDisabled = false;
                    choicesDiv.appendChild(button);
                });

                if (allChoicesDisabled) {
                    if (gameState.fuel <= 0) currentScene = 'stranded';
                    else if (gameState.ammo <= 0) currentScene = 'outOfAmmo';
                    else if (gameState.morale <= 0) currentScene = 'desertion';
                    displayScene();
                }
            }
        }
    </script>
</body>
</html>
